(self.webpackChunkdeviget_react_challenge=self.webpackChunkdeviget_react_challenge||[]).push([[376],{5550:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Oe});var o=r(4699),n=r(7294),a=r(3392),i=r(6156),c=r(7329),s=r(629);const l="idle",d="waiting",u="playing",p="finished",v="full error",g="error";var m=r(2305),f=r.n(m);const x="PLAY",y="SHOW_FULL_ERROR";var b=r(5050);const h=[function(){return document.documentElement.classList.toggle("dark")},(0,b.f0)((function(e){return e.dark=!e.dark}))],w=(0,b.f0)((function(e,t){return e.error={message:t.data&&t.data.message||t.error&&t.error.message}})),k=(0,b.f0)((function(e,t){return e.socket=t.data}));var E=r(5615);const Z={src:function(e,t){return new Promise((function(e,t){try{e((0,E.io)())}catch(e){t(e)}}))},onDone:{target:d,actions:[k]},onError:{target:g,actions:[w]}};var R=r(375);const q="unchecked",O="checked",C="TOGGLE";var N,T={id:"checkbox",initial:q,states:(N={},(0,i.Z)(N,q,{on:(0,i.Z)({},C,[{actions:[(0,R.lj)((function(e,t){return{type:t.payload.event}}))],target:O}])}),(0,i.Z)(N,O,{on:(0,i.Z)({},C,[{actions:[(0,R.lj)((function(e,t){return{type:t.payload.event}}))],target:q}])}),N)};const L=(0,s.C)(T),j="locked",F="unlocked",B="finished",D="LOCK",G="UNLOCK",I="FILL_CIRCLE",A="FINISH",_=(0,b.f0)((function(e,t){return e.board[t.payload.row][t.payload.col]=t.payload.color}));var H,K,S,P={id:"board",initial:j,context:{board:[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]]},states:(S={},(0,i.Z)(S,j,{on:(H={},(0,i.Z)(H,G,F),(0,i.Z)(H,D,j),(0,i.Z)(H,A,B),H)}),(0,i.Z)(S,F,{on:(K={},(0,i.Z)(K,D,j),(0,i.Z)(K,G,F),(0,i.Z)(K,I,{actions:[_],target:F}),(0,i.Z)(K,A,B),K)}),(0,i.Z)(S,B,{entry:(0,R.lj)((function(e,t){return t}))}),S)};const U=(0,s.C)(P),X=(0,R.Tn)(f().BOARD),M=(0,R.Tn)(f().BOARD),W=(0,R.Tn)(f().BOARD),Y=(0,b.f0)((function(e,t){e.playerOne=t.payload.playerOne,e.playerTwo=t.payload.playerTwo})),z=(0,b.f0)((function(e,t){return e.error=void 0}));var J,Q,V,$={id:"game",initial:l,context:{dark:!1,playerOne:void 0,playerTwo:void 0,error:void 0,socket:void 0},invoke:[{id:f().CHECKBOX,src:L},{id:f().BOARD,src:U}],states:(V={},(0,i.Z)(V,l,{invoke:{src:Z.src,onDone:Z.onDone,onError:Z.onError},on:(0,i.Z)({},C,{actions:(0,c.Z)(h),target:l})}),(0,i.Z)(V,d,{on:(J={},(0,i.Z)(J,C,{actions:(0,c.Z)(h),target:d}),(0,i.Z)(J,x,{actions:[Y],target:u}),J)}),(0,i.Z)(V,u,{on:(Q={},(0,i.Z)(Q,C,{actions:(0,c.Z)(h),target:u}),(0,i.Z)(Q,"FINISH",{target:p}),(0,i.Z)(Q,D,{actions:[X],target:u}),(0,i.Z)(Q,G,{actions:[M],target:u}),(0,i.Z)(Q,I,{actions:[W],target:u}),(0,i.Z)(Q,y,{actions:[w],target:v}),Q)}),(0,i.Z)(V,p,{type:"final",on:(0,i.Z)({},C,{actions:(0,c.Z)(h),target:p})}),(0,i.Z)(V,v,{after:{100:{actions:[z],target:u}}}),(0,i.Z)(V,g,{on:(0,i.Z)({},C,{actions:(0,c.Z)(h),target:g})}),V)};const ee=(0,s.C)($);var te=r(5697),re=r.n(te),oe=r(2122),ne=r(9836),ae=r(5142),ie=r(4012),ce=function(e){var t=e.label,r=e.className,a=e.payload,i=e.machine,c=(0,ae.L)(i),s=(0,o.Z)(c,2),l=s[0],d=s[1];return n.createElement("div",{"data-testid":"checkbox-container",className:"flex flex-col items-center cursor-pointer ".concat(r),onClick:function(){d({payload:a,type:C})}},n.createElement("span",{className:"dark:text-pink-400"},n.createElement(ie.Z,{id:t})),n.createElement("input",{type:"checkbox",className:"w-0 h-0"}),n.createElement("div",{"data-testid":"checkbox-child-3",className:"w-8 h-4 rounded-md duration-500 ".concat("checked"===l.value?"bg-pink-400":"bg-gray-400")},n.createElement("div",{"data-testid":"checkbox-child-3.1",className:"bg-white w-4 h-4 rounded-full duration-500 ".concat("checked"===l.value?"transform translate-x-full":"")})))};ce.propTypes={label:re().string.isRequired,payload:re().object.isRequired,className:re().string,machine:re().object.isRequired};const se=ce;var le=r(7375),de=function(e){var t=e.options,r=(0,le.Z)(e,["options"]);return n.createElement("select",r,t.map((function(e){var t=e.key,r=e.value;return n.createElement(ie.Z,{key:t,id:r,defaultMessage:r},(function(e){return n.createElement("option",{value:t},e)}))})))};de.propTypes={options:re().arrayOf(re().shape({key:re().string.isRequired,value:re().string.isRequired}).isRequired).isRequired};const ue=de;var pe=function(e){var t=e.title,r=e.checkbox,o=e.dropdown;return n.createElement("div",{className:"flex flex-row justify-between shadow-md"},n.createElement(ne.Z,{as:"h4",className:"p-5",text:t}),n.createElement("div",{className:"flex flex-row items-center"},n.createElement(ue,o),n.createElement(se,(0,oe.Z)({className:"p-5"},r))))};pe.propTypes={title:re().string.isRequired,checkbox:re().shape({label:re().string.isRequired,payload:re().object.isRequired,machine:re().object.isRequired}).isRequired,dropdown:re().shape({options:re().arrayOf(re().shape({key:re().string.isRequired,value:re().string.isRequired}).isRequired).isRequired})};const ve=pe;var ge=function(e){var t=e.toolbar,r=e.children;return n.createElement("div",{className:"min-h-full dark:bg-gray-800"},n.createElement(ve,t),n.createElement("div",{className:"flex flex-col-reverse justify-around items-center xl:flex-row p-5"},r))};ge.propTypes={toolbar:re().shape({title:re().string.isRequired,checkbox:re().shape({label:re().string.isRequired,payload:re().object.isRequired,machine:re().object.isRequired}).isRequired,dropdown:re().shape({options:re().arrayOf(re().shape({key:re().string.isRequired,value:re().string.isRequired}).isRequired).isRequired})})};const me=ge;var fe=function(e){var t=e.title,r=e.body;return n.createElement("div",{className:"flex flex-col"},n.createElement(ne.Z,{className:"my-2",as:"md",text:t}),n.createElement(ne.Z,{as:"md",text:r}))};fe.propTypes={title:re().string.isRequired,body:re().string.isRequired};const xe=fe;var ye=function(e){var t=e.paragraphs;return n.createElement("div",{className:"shadow-md flex flex-col items-center justify-center p-5 xl:w-1/2 mt-5 xl:mt-0 mr-0 xl:mr-5"},t.map((function(e,t){return n.createElement(xe,(0,oe.Z)({key:t},e))})))};ye.propTypes={paragraphs:re().arrayOf(re().shape({title:re().string.isRequired,body:re().string.isRequired}).isRequired).isRequired};const be=ye;var he=["64","192","320","448","576","704","832"],we=["64","192","320","448","576","704"],ke=function(e){var t=e.dark,r=e.machine,a=e.onClickCircle,i=(0,ae.L)(r),c=(0,o.Z)(i,2),s=c[0],l=c[1],d=function(){for(var e=0;e<s.context.board[0].length;e++){for(var t="",r=0;r<s.context.board.length;r++)t+=s.context.board[r][e]+",";if(new RegExp(/red,red,red,red/).exec(t))return"red";if(new RegExp(/blue,blue,blue,blue/).exec(t))return"blue"}},u=function(){for(var e=[[{row:2,positive:0,negative:6},{row:3,positive:1,negative:5},{row:4,positive:2,negative:4},{row:5,positive:3,negative:3}],[{row:1,positive:0,negative:6},{row:2,positive:1,negative:5},{row:3,positive:2,negative:4},{row:4,positive:3,negative:3},{row:5,positive:4,negative:2}],[{row:0,positive:0,negative:6},{row:1,positive:1,negative:5},{row:2,positive:2,negative:4},{row:3,positive:3,negative:3},{row:4,positive:4,negative:2},{row:5,positive:5,negative:1}],[{row:0,positive:1,negative:5},{row:1,positive:2,negative:4},{row:2,positive:3,negative:3},{row:3,positive:4,negative:2},{row:4,positive:5,negative:1},{row:5,positive:6,negative:0}],[{row:0,positive:2,negative:4},{row:1,positive:3,negative:3},{row:2,positive:4,negative:3},{row:3,positive:5,negative:1},{row:4,positive:6,negative:0}],[{row:0,positive:3,negative:3},{row:1,positive:4,negative:2},{row:2,positive:5,negative:1},{row:3,positive:6,negative:0}]],t=0;t<e.length;t++){for(var r="",o="",n=0;n<e[t].length;n++)r+=s.context.board[e[t][n].row][e[t][n].positive]+",",o+=s.context.board[e[t][n].row][e[t][n].negative]+",";if(new RegExp(/red,red,red,red/).exec(r)||new RegExp(/red,red,red,red/).exec(o))return"red";if(new RegExp(/blue,blue,blue,blue/).exec(r)||new RegExp(/blue,blue,blue,blue/).exec(o))return"blue"}},p=function(e,t){return function(){a(function(e){for(var t=s.context.board.length-1;t>=0;t--)if(!s.context.board[t][e])return t;return-1}(t),t)}};return(0,n.useEffect)((function(){var e=[s.context.board.some((function(e){return new RegExp(/red,red,red,red/).exec(e.join(","))?"red":new RegExp(/blue,blue,blue,blue/).exec(e.join(",")?"blue":void 0)})),d(),u()].find((function(e){return e}));e&&l({type:A,payload:{winner:e}})}),[s.context.board]),n.createElement("div",{className:"flex justify-center"},n.createElement("svg",{width:"700",height:"600",viewBox:"0 0 896 768"},n.createElement("rect",{width:"896",height:"768",rx:"29",fill:t?"#FFFFFF":"#27272A"}),we.map((function(e,t){return he.map((function(r,o){return n.createElement("circle",{className:"".concat(s.matches(j)||s.matches(B)?"cursor-not-allowed":"cursor-pointer"),fill:s.context.board[t][o]||"#C4C4C4",r:"50",key:"".concat(t,",").concat(o),cx:r,cy:e,onClick:s.matches(j)||s.matches(B)?null:p(0,o)})}))}))))};ke.propTypes={dark:re().bool.isRequired,machine:re().object.isRequired,onClickCircle:re().func.isRequired};const Ee=ke;var Ze=r(4248),Re=r(7281),qe=r(5575);const Oe=function(){var e=(0,a.eO)(ee,{devTools:!0}),t=(0,o.Z)(e,2),r=t[0],i=t[1],c=(0,Ze.v)(),s=(0,o.Z)(c,2),l=s[0],d=s[1],u=(0,qe.h)(),m=(0,o.Z)(u,2),f=(m[0],m[1]);return(0,n.useEffect)((function(){if(r.context.socket)return r.context.socket.on("full",(function(e,t){r.context.socket.disconnect(!0)})),r.context.socket.on("message",(function(e,t){var o=e.row,n=e.col,a=e.socketId;t(),i({type:G}),i({type:I,payload:{row:o,col:n,color:a===r.context.playerOne?"red":"blue"}})})),r.context.socket.on("ready",(function(e,t){var o=e.playerOne,n=e.playerTwo;i({type:x,payload:{playerOne:o,playerTwo:n}}),i({type:o===r.context.socket.id?G:D})})),function(){r.context.socket&&(r.context.socket.removeListener("message"),r.context.socket.removeListener("ready"),r.context.socket.removeListener("full"))}}),[r]),(0,n.useEffect)((function(){r.matches(v)&&f({type:Re.Z.TOGGLE,payload:{type:"error",message:"game.txt13"}}),r.matches(g)&&f({type:Re.Z.TOGGLE,payload:{type:"error",message:r.context.error.message}})}),[r.context.error]),(0,n.useEffect)((function(){r.matches(p)&&f({type:Re.Z.TOGGLE,payload:{type:"success",message:"red"===r.event.payload.winner?"game.txt14":"game.txt15"}})}),[r]),n.createElement(me,{toolbar:{title:"toolbar.txt1",checkbox:{label:"toolbar.txt2",payload:{event:C},machine:r.children.checkbox},dropdown:{value:l,onChange:function(e){d(e.target.value)},options:[{key:"en",value:"game.txt11"},{key:"es",value:"game.txt12"}]}}},n.createElement(be,{paragraphs:[{title:"game.txt1",body:"game.txt2"},{title:"game.txt3",body:"game.txt4"},{title:"game.txt5",body:"game.txt6"},{title:"game.txt7",body:"game.txt8"},{title:"game.txt9",body:"game.txt10"}]}),n.createElement(Ee,{dark:r.context.dark,machine:r.children.board,onClickCircle:function(e,t){if(-1===e)return i({type:y});r.context.socket.send({socketId:r.context.socket.id,row:e,col:t},(function(){i({type:I,payload:{row:e,col:t,color:r.context.socket.id===r.context.playerOne?"red":"blue"}}),i({type:D})}))}}))}},2305:e=>{e.exports={CHECKBOX:"checkbox",BOARD:"board"}}}]);